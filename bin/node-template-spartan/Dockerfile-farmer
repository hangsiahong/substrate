FROM ubuntu:20.04

RUN \
    apt-get update && \
    DEBIAN_FRONTEND=noninteractive apt-get install -y --no-install-recommends \
        ca-certificates \
        curl \
        gcc \
        llvm \
        clang \
        make \
        m4 \
        netcat-openbsd && \
    curl --proto '=https' --tlsv1.2 -sSf https://sh.rustup.rs | sh -s -- -y --default-toolchain nightly

RUN bash -c "source /root/.cargo/env && cargo install spartan-farmer"

COPY entrypoint-farmer.sh /entrypoint-farmer.sh

ENTRYPOINT ["/entrypoint-farmer.sh"]
